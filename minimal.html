<head>
  <!-- Polyfill for link import, etc. -->
  <script src="bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <!-- ES6 polyfill for older browsers -->
  <script src="bower_components/es6-shim/es6-shim.min.js"></script>
  <link rel="import" href="board-viewer.html">
<style>
#popup {
  display: inline-block;
  background: white;
  border: 1px solid black;
  position: absolute;
  left: 25%;
  right: 25%;
  top: 25%;
  bottom: 25%;
  overflow: auto;
  padding: 1em;
}
</style>


</head>
<body>
  <board-viewer disable-zoom disable-drag id="bv"></board-viewer>
<script>
document.addEventListener('DOMContentLoaded', function() {
  var bv = document.querySelector('#bv');
  bv.addEventListener('board-changed', function(event) {
    console.log("New board loaded: " + event.detail.value);
    bv.addFilter("SDA and SDC I2C pins", {
      type: "LIST",
      set: [ "J11Pin10", "J11Pin9" ]
    }, {
      color: "#f000d0",
      interactive: false,
      alwaysVisible: true
    });

    bv.addFilter("Pins", {
      type: "PIN",
      pattern: "*"
    }, {
        color: "yellow",
        alwaysVisible: false
    });

    bv.addFilter("Components", {
      type: "COMPONENT",
      pattern: "*"
    }, {
        color: "#00d0f0",
        alwaysVisible: false
    });
  });
  bv.setBoard("arduino_101");
  bv.addEventListener("item-hover", function(event) {
    if (event.detail.in) {
      window.location.hash = event.detail.refdes;
    } else {
      window.location.hash = '';
    }
  });

  var timeout;

  bv.addEventListener("item-tap", function(event) {
    bv.getDocumentation(event.detail.refdes, "HTML", function(content) {
      var div = document.querySelector("#popup");
      div = div || document.createElement('div');
      div.id = "popup";
      div.innerHTML = (content.error) ? content.error : content;
      document.body.appendChild(div);
      if (timeout) {
        clearTimeout(timeout);
      }
      timeout = setTimeout(function() {
        var div = document.body.querySelector("#popup");
        div.parentElement.removeChild(div);
      }, 3000);
    });
  });
});
</script>
</body>
